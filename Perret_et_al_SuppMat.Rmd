---
title: Supplementary Material for "Spatially balanced sampling methods are always
  more precise than random ones for estimating the size of aggregated populations"
author: |
 | Jan Perret ([orcid](https://orcid.org/0000-0002-1912-6995)), Anne Charpentier ([orcid](https://orcid.org/0000-0002-8588-6001)), Roger Pradel ([orcid](https://orcid.org/0000-0002-2684-9251)), 
 | Guillaume Papuga ([orcid](https://orcid.org/0000-0002-7803-2219)), Aurélien Besnard ([orcid](https://orcid.org/0000-0002-2289-9761))
date: "Created on the 2022-08-01"
header-includes:
  - \usepackage{graphicx}
  - \usepackage{grffile}
output:
  pdf_document:
    toc: yes
    toc_depth: '3'
  html_document:
    number_sections: no
    theme: paper
    toc: yes
    toc_depth: 3
  word_document:
    toc: yes
    toc_depth: '3'
toc-title: Table of Content
---

<style>
body {
text-align: justify;
font-size: 12pt;
}
</style>


```{r global_options, include = FALSE}
# set global chunk options
rm(list = ls())
library(knitr)
opts_chunk$set(fig.width = 9, fig.height = 7, fig.align = 'center',
               echo = FALSE, warning = FALSE, message = FALSE)

```


```{r packages, include = FALSE}
# load packages
library(spatstat)
library(ggplot2)
library(dplyr)
library(tidyr)
library(ggpubr)
library(readr)
library(flextable)

```


```{r load data, include = FALSE}
# load data
simul_result <- read.csv2(file = "./data/tidy/RUN_2022-06-08_simul_aggregation_intensity_results_merged_patterns_1-60_averaged.csv")
simul_result_additional_intensities <- read.csv2(file = "./data/tidy/RUN_2022-06-08_simul_aggregation_intensity_results_additional_intensities_merged_patterns_1-60_averaged.csv")
simul_result <- rbind(simul_result, simul_result_additional_intensities)

df_SBS_dist_neighbours <- read.csv2(file = "./data/tidy/BAS_mean_distance_nearest_units_14_neighbours.csv")
coef_tab_modality_1 <- read.csv2("./data/tidy/Matern_parameters_coef_tab_total_2021-06-13.csv")
coef_tab_modality_2 <- read.csv2("./data/tidy/Matern_parameters_coef_tab_total_2021-06-24_kappa.csv")
coef_tab_modality_3 <- read.csv2("./data/tidy/Matern_parameters_coef_tab_total_2021-06-24_mu.csv")
simul_result_modality_2 <- read.csv2(file = "./data/tidy/RUN_2022-06-08_simul_aggregation_intensity_results_modality_2_merged_averaged.csv")
simul_result_modality_3 <- read.csv2(file = "./data/tidy/RUN_2022-06-08_simul_aggregation_intensity_results_modality_3_merged_averaged.csv")

# convert sample_size to factor
simul_result$sample_size <- factor(simul_result$sample_size, levels = c("9", "15", "25", "49", "100", "150", "196", "300", "400"))
df_SBS_dist_neighbours$sample_size <- factor(df_SBS_dist_neighbours$sample_size, levels = c("9", "15", "25", "49", "100", "150", "196", "300", "400"))
simul_result_modality_2$sample_size <- factor(simul_result_modality_2$sample_size, levels = c("9", "15", "25", "49", "100", "150", "196", "300", "400"))
simul_result_modality_3$sample_size <- factor(simul_result_modality_3$sample_size, levels = c("9", "15", "25", "49", "100", "150", "196", "300", "400"))

```


<br>


# Appendix S1. Comparison of the three modalities used to increase the density of the virtual populations simulated with the Matérn Cluster process

## Parameter values of the Matérn cluster process

Figure S1.1 shows the values of the three parameters of the Matérn cluster process we used to simulate the virtual populations in order to obtain the desired dispersion index levels. For modalities 1 and 3, we had to increase the cluster radius when increasing population density in order to maintain the same value of dispersion index. Thus, populations with the same dispersion index had larger clusters as density increased. In contrast, for modality 2, clusters had the same radius for the same level of dispersion index at all densities.  <br>

```{r Fig. S1.1, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 17, fig.width = 14}
# MODALITY 1
myplot_scale <- ggplot(coef_tab_modality_1,
                       aes(x = my_scale, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Scale') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 28) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

myplot_mu <- ggplot(coef_tab_modality_1,
                    aes(x = my_mu, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Mu') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 3000) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

myplot_kappa <- ggplot(coef_tab_modality_1,
                       aes(x = my_kappa, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Kappa') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 0.3) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

# arrange the 3 graphs on a single page
fig_S1_modality_1 <- ggpubr::ggarrange(myplot_kappa, myplot_mu, myplot_scale,
                       ncol = 3, nrow = 1,
                       common.legend = TRUE, legend = "none")
fig_S1_modality_1 <- ggpubr::annotate_figure(fig_S1_modality_1,
                             top = text_grob("Density driven by both mu and kappa (Modality 1)", face = "bold", size = 20))

# MODALITY 2
myplot_scale <- ggplot(coef_tab_modality_2,
                       aes(x = my_scale, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Scale') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 28) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

myplot_mu <- ggplot(coef_tab_modality_2,
                    aes(x = my_mu, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Mu') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 3000) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

myplot_kappa <- ggplot(coef_tab_modality_2,
                       aes(x = my_kappa, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Kappa') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 0.3) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

# arrange the 3 graphs on a single page
fig_S1_modality_2 <- ggpubr::ggarrange(myplot_kappa, myplot_mu, myplot_scale,
                       ncol = 3, nrow = 1,
                       common.legend = TRUE, legend = "none")
fig_S1_modality_2 <- ggpubr::annotate_figure(fig_S1_modality_2,
                             top = text_grob("Density driven by kappa (Modality 2)", face = "bold", size = 20))

# MODALITY 3
myplot_scale <- ggplot(coef_tab_modality_3,
                       aes(x = my_scale, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Scale') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 28) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

myplot_mu <- ggplot(coef_tab_modality_3,
                    aes(x = my_mu, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Mu') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 3000) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

myplot_kappa <- ggplot(coef_tab_modality_3,
                       aes(x = my_kappa, y = expect_disp_ind, color = as.factor(theoretical_intensity))) +
  geom_line(size = 1.5) +
  xlab('Kappa') +
  ylab("Dispersion index") +
  labs(color = "Intensity") +
  theme_bw() +
  theme(text = element_text(size = 20)) +
  xlim(0, 0.3) + 
  theme(legend.position = "bottom") +
  guides(color = guide_legend(nrow = 2, byrow = TRUE))

# arrange the 3 graphs on a single page
fig_S1_modality_3 <- ggpubr::ggarrange(myplot_kappa, myplot_mu, myplot_scale,
                       ncol = 3, nrow = 1,
                       common.legend = TRUE, legend = "none")
fig_S1_modality_3 <- ggpubr::annotate_figure(fig_S1_modality_3,
                             top = text_grob("Density driven by mu (Modality 3)", face = "bold", size = 20))

# combine the 3 plots
fig_S1_1 <- ggpubr::ggarrange(fig_S1_modality_1, fig_S1_modality_2, fig_S1_modality_3,
                              ncol = 1, nrow = 3,
                              common.legend = TRUE, legend = "bottom", legend.grob = get_legend(myplot_kappa))
fig_S1_1

```

**Figure S1.1:** Parameter values of the Matérn cluster process used to obtain the desired dispersion index levels under the three possible modalities for increasing the mean density of the virtual populations. The three parameters were the mean density of clusters (kappa), the mean number of individuals per cluster (mu), and the cluster radius (scale).  <br>

  <br>

## Variance ratio as a function of the dispersion index


```{r Fig. S1.2 modality 1, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7.6, fig.width = 6.4}
palette <- rev(c('#9e0142','#d53e4f','#f46d43','#fdae61','#e6f598','#abdda4','#66c2a5','#3288bd','#5e4fa2'))

### modality 1
fig_S1_2_SYS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                       aes(x = dispersion_index, y = var_ratio_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Systematic) / Var(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
    labs(color = "Sample size") +
  scale_color_manual(values = palette)

fig_S1_2_SBS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                       aes(x = dispersion_index, y = var_ratio_BAS, color = sample_size)) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Spatially Balanced) / Var(Random)") +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)

# combine the plots
fig_S1_2_modality_1 <- ggarrange(fig_S1_2_SYS, fig_S1_2_SBS,
                      ncol = 1, nrow = 2, common.legend = TRUE, legend = "top")

fig_S1_2_modality_1 <- annotate_figure(fig_S1_2_modality_1,
                            bottom = text_grob("Dispersion index", size = 11),
                            left = text_grob("Variance ratio", size = 11, rot = 90),
                            top = text_grob("Modality 1", size = 16, face = "bold"))
fig_S1_2_modality_1

```

<br>

```{r Fig. S1.2 modality 2, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7.6, fig.width = 6.4}
### modality 2
fig_S1_2_SYS <- ggplot(subset(simul_result_modality_2, simul_result_modality_2$theoretical_intensity %in% c(1, 10, 20)),
                       aes(x = dispersion_index, y = var_ratio_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Systematic) / Var(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)

fig_S1_2_SBS <- ggplot(subset(simul_result_modality_2, simul_result_modality_2$theoretical_intensity %in% c(1, 10, 20)),
                       aes(x = dispersion_index, y = var_ratio_BAS, color = sample_size)) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Spatially Balanced) / Var(Random)") +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)

# combine the plots
fig_S1_2_modality_2 <- ggarrange(fig_S1_2_SYS, fig_S1_2_SBS,
                                 ncol = 1, nrow = 2, common.legend = TRUE, legend = "top")

fig_S1_2_modality_2 <- annotate_figure(fig_S1_2_modality_2,
                                       bottom = text_grob("Dispersion index", size = 11),
                                       left = text_grob("Variance ratio", size = 11, rot = 90),
                                       top = text_grob("Modality 2", size = 16, face = "bold"))
fig_S1_2_modality_2

```

<br>

```{r Fig. S1.2 modality 3, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7.6, fig.width = 6.4}
### modality 3
fig_S1_3_SYS <- ggplot(subset(simul_result_modality_3, simul_result_modality_3$theoretical_intensity %in% c(1, 10, 20)),
                       aes(x = dispersion_index, y = var_ratio_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Systematic) / Var(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)

fig_S1_3_SBS <- ggplot(subset(simul_result_modality_3, simul_result_modality_3$theoretical_intensity %in% c(1, 10, 20)),
                       aes(x = dispersion_index, y = var_ratio_BAS, color = sample_size)) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Spatially Balanced) / Var(Random)") +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)

# arrange the plots on a single page
fig_S1_2_modality_3 <- ggarrange(fig_S1_3_SYS, fig_S1_3_SBS,
                      ncol = 1, nrow = 2, common.legend = TRUE, legend = "top")

fig_S1_2_modality_3 <- annotate_figure(fig_S1_2_modality_3,
                            bottom = text_grob("Dispersion index", size = 11),
                            left = text_grob("Variance ratio", size = 11, rot = 90),
                            top = text_grob("Modality 3", size = 16, face = "bold"))
fig_S1_2_modality_3

```

**Figure S1.2:** Ratio of the sampling variance of systematic sampling (SYS) and spatially balanced sampling (SBS) over the sampling variance of simple random sampling (SRS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). For the aggregated populations, density was increased by increasing either both kappa and mu (modality 1), only kappa (modality 2) or only mu (modality 3). Each point of the curves is the ratio of two sampling variances estimated from 1,000 samples drawn for 60 populations.  <br>

<br>

## SYS variance ratio as a function of cluster diameter

<br>

```{r  Fig. S1.3 modality 1, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7, fig.width = 6.4}
# mean distance between units for systematic sampling
dist_df_syst <- data.frame(
  sample_size = c(     9,     15,     25,     49,    100,   150,   196,   300,   400),
  mean_dist =   c(40.232, 30.733, 24.142, 17.243, 12.071, 9.561, 8.621, 6.666, 6.035)) # accounting for direct neighbours and diagonal neighbours

# convert sample_size to factor with right order
dist_df_syst$sample_size <- factor(dist_df_syst$sample_size, levels = c("9", "15", "25", "49", "100", "150", "196", "300", "400"))

# color palette for the plots
palette2_full <- c('#fed976','#feb24c','#fd8d3c','#fc4e2a','#e31a1c','#bd0026','#800026')
palette2 <- c('#fed976','#feb24c','#fd8d3c','#e31a1c')


### modality 1

# restrict plots to levels given below
wanted_intensities = c(1, 5, 10, 15, 20, 25, 30)
wanted_sample_sizes = c(49, 150, 300, 400)
wanted_sample_sizes = c(49, 100, 196, 400)


fig_S1_3_modality_1 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% wanted_intensities &
                                   simul_result$sample_size %in% wanted_sample_sizes),
                          aes(x = cluster_diam, y = var_ratio_syst, color = as.factor(theoretical_intensity))) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 26), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Systematic) / Var(random)") +
  facet_grid(sample_size ~ .) +
  geom_vline(data = subset(dist_df_syst, dist_df_syst$sample_size %in% wanted_sample_sizes),
             aes(xintercept = mean_dist), size = 0.5) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        legend.margin = margin(0, 0, 0, 0), legend.box.margin = margin(-6, -6, -6, -6)) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Population density (individuals/cell)") +
  xlab("Cluster diameter") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette2_full)

fig_S1_3_modality_1 <- ggarrange(fig_S1_3_modality_1, ncol = 1, nrow = 1)
fig_S1_3_modality_1 <- annotate_figure(fig_S1_3_modality_1, top = text_grob("Modality 1", size = 16, face = "bold"))
fig_S1_3_modality_1

```

<br>

```{r  Fig. S1.3 modality 2, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7, fig.width = 6.4}
### modality 2

# restrict plots to levels given below
wanted_intensities = c(1, 5, 10, 20)
wanted_sample_sizes = c(49, 150, 300, 400)
wanted_sample_sizes = c(49, 100, 196, 400)


fig_S1_3_modality_2 <- ggplot(subset(simul_result_modality_2, simul_result_modality_2$theoretical_intensity %in% wanted_intensities &
                                       simul_result_modality_2$sample_size %in% wanted_sample_sizes),
                              aes(x = cluster_diam, y = var_ratio_syst, color = as.factor(theoretical_intensity))) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 26), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Systematic) / Var(random)") +
  facet_grid(sample_size ~ .) +
  geom_vline(data = subset(dist_df_syst, dist_df_syst$sample_size %in% wanted_sample_sizes),
             aes(xintercept = mean_dist), size = 0.5) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        legend.margin = margin(0, 0, 0, 0), legend.box.margin = margin(-6, -6, -6, -6)) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Population density (individuals/cell)") +
  xlab("Cluster diameter") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette2)

fig_S1_3_modality_2 <- ggarrange(fig_S1_3_modality_2, ncol = 1, nrow = 1)
fig_S1_3_modality_2 <- annotate_figure(fig_S1_3_modality_2, top = text_grob("Modality 2", size = 16, face = "bold"))
fig_S1_3_modality_2

```

<br>

```{r  Fig. S1.3 modality 3, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7, fig.width = 6.4}
### modality 3

# restrict plots to levels given below
wanted_intensities = c(1, 5, 10, 20)
wanted_sample_sizes = c(49, 150, 300, 400)
wanted_sample_sizes = c(49, 100, 196, 400)


fig_S1_3_modality_3 <- ggplot(subset(simul_result_modality_3, simul_result_modality_3$theoretical_intensity %in% wanted_intensities &
                                simul_result_modality_3$sample_size %in% wanted_sample_sizes),
                       aes(x = cluster_diam, y = var_ratio_syst, color = as.factor(theoretical_intensity))) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 26), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Systematic) / Var(random)") +
  facet_grid(sample_size ~ .) +
  geom_vline(data = subset(dist_df_syst, dist_df_syst$sample_size %in% wanted_sample_sizes),
             aes(xintercept = mean_dist), size = 0.5) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        legend.margin = margin(0, 0, 0, 0), legend.box.margin = margin(-6, -6, -6, -6)) + # to reduce the space between the plot and the legend
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Population density (individuals/cell)") +
  xlab("Cluster diameter") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette2)

fig_S1_3_modality_3 <- ggarrange(fig_S1_3_modality_3, ncol = 1, nrow = 1)
fig_S1_3_modality_3 <- annotate_figure(fig_S1_3_modality_3, top = text_grob("Modality 3", size = 16, face = "bold"))
fig_S1_3_modality_3

```


**Figure S1.3:** Ratio of the sampling variance of systematic sampling (SYS) over the sampling variance of simple random sampling (SRS) for the aggregated populations. The x-axis is the cluster diameter, and panels show four different sample sizes. Each curve shows the variance ratio obtained for a different mean density of individuals. The black vertical lines show the point where the distance between the sampling units is equal to the cluster diameter. Density was increased by increasing either both kappa and mu (modality 1), only kappa (modality 2) or only mu (modality 3).

<br>

## SBS variance ratio as a function of cluster diameter

<br>

```{r  Fig. S1.4 modality 1, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7, fig.width = 6.4}
# compute the mean distance to the 4 nearest neighbours
df_SBS_dist_neighbours <- cbind(df_SBS_dist_neighbours, mean_dist = rowMeans(df_SBS_dist_neighbours[, 2:13]))

# restrict plots to levels given below
wanted_intensities = c(1, 5, 10, 15, 20, 25, 30)
wanted_sample_sizes = c(49, 150, 300, 400)
wanted_sample_sizes = c(49, 100, 196, 400)

### modality 1
fig_S1_4_modality_1 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% wanted_intensities &
                                   simul_result$sample_size %in% wanted_sample_sizes),
                          aes(x = cluster_diam, y = var_ratio_BAS, color = as.factor(theoretical_intensity))) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 26), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Spatially Balanced) / Var(random)") +
  facet_grid(sample_size ~ .) +
  geom_vline(data = subset(df_SBS_dist_neighbours, df_SBS_dist_neighbours$sample_size %in% wanted_sample_sizes),
             aes(xintercept = mean_dist), size = 0.5) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        legend.margin = margin(0, 0, 0, 0), legend.box.margin = margin(-6, -6, -6, -6)) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Population density (individuals/cell)") +
  xlab("Cluster diameter") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette2_full)

fig_S1_4_modality_1 <- ggarrange(fig_S1_4_modality_1, ncol = 1, nrow = 1)
fig_S1_4_modality_1 <- annotate_figure(fig_S1_4_modality_1, top = text_grob("Modality 1", size = 16, face = "bold"))
fig_S1_4_modality_1

```

<br>

```{r  Fig. S1.4 modality 2, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7, fig.width = 6.4}
### modality 2

# restrict plots to levels given below
wanted_intensities = c(1, 5, 10, 20)
wanted_sample_sizes = c(49, 150, 300, 400)
wanted_sample_sizes = c(49, 100, 196, 400)


# keep only wanted sample sizes and densities
simul_result_modality_2_sub <- subset(simul_result_modality_2, simul_result_modality_2$theoretical_intensity %in% wanted_intensities &
                                   simul_result_modality_2$sample_size %in% wanted_sample_sizes)
simul_result_modality_2_sub$sample_size <- factor(simul_result_modality_2_sub$sample_size)

# make the plot
fig_S1_4_modality_2 <- ggplot(simul_result_modality_2_sub,
                          aes(x = cluster_diam, y = var_ratio_BAS, color = as.factor(theoretical_intensity))) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 26), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Spatially Balanced) / Var(random)") +
  facet_grid(sample_size ~ .) +
  geom_vline(data = subset(df_SBS_dist_neighbours, df_SBS_dist_neighbours$sample_size %in% wanted_sample_sizes),
             aes(xintercept = mean_dist), size = 0.5) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        legend.margin = margin(0, 0, 0, 0), legend.box.margin = margin(-6, -6, -6, -6)) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Population density (individuals/cell)") +
  xlab("Cluster diameter") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette2)

fig_S1_4_modality_2 <- ggarrange(fig_S1_4_modality_2, ncol = 1, nrow = 1)
fig_S1_4_modality_2 <- annotate_figure(fig_S1_4_modality_2, top = text_grob("Modality 2", size = 16, face = "bold"))
fig_S1_4_modality_2

```

<br>

```{r  Fig. S1.4 modality 3, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 7, fig.width = 6.4}
### modality 3

# restrict plots to levels given below
wanted_intensities = c(1, 5, 10, 20)
wanted_sample_sizes = c(49, 150, 300, 400)
wanted_sample_sizes = c(49, 100, 196, 400)


# keep only wanted sample sizes and densities
simul_result_modality_3_sub <- subset(simul_result_modality_3, simul_result_modality_3$theoretical_intensity %in% wanted_intensities &
                                   simul_result_modality_3$sample_size %in% wanted_sample_sizes)
simul_result_modality_3_sub$sample_size <- factor(simul_result_modality_3_sub$sample_size)

# make the plot
fig_S1_4_modality_3 <- ggplot(simul_result_modality_3_sub,
                       aes(x = cluster_diam, y = var_ratio_BAS, color = as.factor(theoretical_intensity))) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 26), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.05, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var(Spatially Balanced) / Var(random)") +
  facet_grid(sample_size ~ .) +
  geom_vline(data = subset(df_SBS_dist_neighbours, df_SBS_dist_neighbours$sample_size %in% wanted_sample_sizes),
             aes(xintercept = mean_dist), size = 0.5) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 10), axis.title.y = element_text(size = 10),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        legend.margin = margin(0, 0, 0, 0), legend.box.margin = margin(-6, -6, -6, -6)) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Population density (individuals/cell)") +
  xlab("Cluster diameter") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette2)

fig_S1_4_modality_3 <- ggarrange(fig_S1_4_modality_3, ncol = 1, nrow = 1)
fig_S1_4_modality_3 <- annotate_figure(fig_S1_4_modality_3, top = text_grob("Modality 3", size = 16, face = "bold"))
fig_S1_4_modality_3

```


**Figure S1.4:** Ratio of the sampling variance of spatially balanced sampling (SBS) over the sampling variance of simple random sampling (SRS) for the aggregated populations. The x-axis is the cluster diameter, and panels show four different sample sizes. Each curve shows the variance ratio obtained for a different mean density of individuals. The black vertical lines show the point where the mean distance to the twelve nearest sampling units is equal to the cluster diameter. Density was increased by increasing either both kappa and mu (modality 1), only kappa (modality 2) or only mu (modality 3).  <br>

<br>

# Appendix S2. Examples of simulated virtual populations

The examples of the simulated virtual populations are in the file “Appendix_S2_pattern_illustration.zip”. For the populations simulated using the SSI process, examples are presented for mean densities of 1, 10 and 20 individuals/cell, and levels of dispersion index I = 0.4, 0.6 and 0.8. For the populations simulated using the Matérn cluster process, examples are presented for mean densities of 1, 5, 10, 15, 20, 25 and 30 individuals/cell, and levels of dispersion index of I = 6, 15, 30, 45 and 75. Examples of population are presented for the three density increase modalities. For populations simulated with the Poisson process (I = 1), examples are presented on the same page as the populations simulated with the Matérn cluster process. For the three point processes, the same parameter values were used as for the simulations presented in the main text, but the simulation window was reduced to 25x25 (instead of 100x100) for illustrative purposes. A histogram showing the number of individuals per 1x1 cell is associated to each virtual population.  <br>


<br>


# Appendix S3. Verification of lack of bias in the density estimates

For all populations, both virtual and natural, whatever the sample size, the mean density estimates resulting from the three sampling methods were always very close to the true population density. The difference between the estimated density and the true density was usually less than 0.1 individual/cell, and sometimes less than 0.01 individual/cell. This indicates that all sampling methods provided unbiased estimates, regardless of the density of the studied population, its aggregation level and the sample size used. This result was expected from sampling theory, as for the three sampling methods the sample mean is a design-unbiased estimator of the population mean, meaning that the estimates will be unbiased whatever the characteristics of the studied population (Thompson, 2012). Figure S3.1 shows the difference between the true population density and the estimated population density for the virtual populations and sampling designs presented in Figure 2 of the main text. Similar results were found for all densities we simulated, and for the three modalities used to increase population density with the Matérn cluster process.  <br>

```{r Fig. S3.1, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 11.4, fig.width = 6.4}

# color palette for the plots
palette <- rev(c('#9e0142','#d53e4f','#f46d43','#fdae61','#e6f598','#abdda4','#66c2a5','#3288bd','#5e4fa2'))

# make the plot for SRS
figureS3.1_SRS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = dispersion_index, y = biais_random, color = sample_size)) +
  geom_hline(yintercept = 0, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(-0.22, 0.22), expand = expansion(mult = c(0, 0))) +
  ggtitle("Simple Random Sampling (SRS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)

# make the plot for SYS
figureS3.1_SYS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = dispersion_index, y = biais_syst, color = sample_size)) +
  geom_hline(yintercept = 0, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(-0.22, 0.22), expand = expansion(mult = c(0, 0))) +
  ggtitle("Systematic Sampling (SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)


# make the plot for SBS
figureS3.1_SBS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = dispersion_index, y = biais_BAS, color = sample_size)) +
  geom_hline(yintercept = 0, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(-0.22, 0.22), expand = expansion(mult = c(0, 0))) +
  ggtitle("Spatially Balanced Sampling (SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_blank(), axis.title.y = element_blank(),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  scale_color_manual(values = palette)


# arrange the plots together
figureS3.1 <- ggpubr::ggarrange(figureS3.1_SRS, figureS3.1_SYS, figureS3.1_SBS,
                             ncol = 1, nrow = 3, common.legend = TRUE, legend = "top")

figureS3.1 <- ggpubr::annotate_figure(figureS3.1,
                                   bottom = text_grob("Dispersion index", size = 11),
                                   left = text_grob("Difference between estimated and true population density (individuals/cell)", size = 11, rot = 90))

figureS3.1

```

**Figure S3.1:** Difference between the true population density and the estimated population density obtained with simple random sampling (SRS), systematic sampling (SYS) and spatially balanced sampling (SBS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). For the aggregated populations, density was increased by simultaneously increasing the number of clusters and the number of individuals per cluster (modality 1). Each point of the curves was obtained by computing the average over 60 populations of the difference between the true density and the mean of 1,000 sample means.  <br>

<br>

# Appendix S4. Test of variance estimators

In the main text of the paper we have shown that on average SYS and SBS provide more precise or at least as precise population size estimates as SRS for aggregated populations. However, a main difficulty when using SYS (and to a lesser extent for SBS) is to obtain an accurate variance estimate from a single sample, to have a reliable estimate of the uncertainty associated to the population size estimate. We therefore assessed the performance of multiple variance estimators that have shown promising results in recent studies, and proposed an additional estimator (V_ZIP) that is more adapted for populations following the Matern cluster process we used to simulate our virtual populations. Our goal was to check if the gain in precision of the population size estimates we have shown is not lost because of poor variance estimators available for SYS and SBS. We performed these tests on both the virtual and the three natural populations we studied.  <br>

**Take home message:** As expected, for the virtual populations, the variance estimators we selected from previous studies for SYS overestimated sampling variance when the distance between the sampling units was close to the mean cluster diameter. Conversely, our estimator V_ZIP was almost unbiased under these conditions, but it underestimated variance for higher aggregation levels. For SBS, the most commonly used estimator in the literature (V_nbh) had relatively good performances. For the natural populations using SYS or SBS, both some estimators from previous studies and our V_ZIP estimator performed well, yielding almost unbiased estimates of sampling variance. Overall, using SYS or SBS instead of SRS with a variance estimator that is appropriate for the studied population will generally result in a substantial gain in ‘apparent’ precision, although this gain will usually be slightly smaller than the gain in true precision.  <br>

 <br>

## Methods

The variance estimators we selected for this study are presented in Table S4.1. For SBS, a single estimator (V_nbh) was identified as the best performing in all studies (e.g. Grafstrom et al., 2012; Robertson et al., 2013). For SYS, we chose the best performing estimators among the 16 that have been tested in three recent studies (McGarvey et al., 2016; Magnussen & Fehrmann, 2019; Magnussen et al., 2020).  <br>

All these estimators are based on the same principle: compute the sample variance and a correlation metric of the abundance among neighbouring sample units; use the correlation metric to weight the sample variance. Several correlation metrics (e.g. Moran’s I for V_w, Geary’s C for V_str2) and several definitions of the neighbourhood (e.g. the 4 closest units, all units within a given radius) are possible, but apart from that, the principle remains the same. Thus, these estimators are relevant only when there is correlation of abundance among neighbouring units in the sample.  <br> 

Yet for our virtual populations simulated using a Matern process, when sampling with SYS (and to a lesser extent SBS), for sample sizes for which the distance between the sampling units is equal to the diameter of the clusters (allowing the largest gain in precision compared to SRS), there is no correlation between the neighbouring units included in the sample. Indeed, under these conditions, there can only be one sample unit per cluster, and as the position of the clusters is random, whether a unit is in a cluster or not is independent of whether its neighbouring units are in a cluster or not. Therefore, the estimators using the correlation between neighbouring units in the sample will considerably overestimate the sampling variance under these conditions. In addition, the individuals inside clusters are randomly located, i.e. following a Poisson process. We have therefore proposed a new variance estimator that is better adapted to populations where individuals are grouped in well-defined clusters.  <br>

Our new estimator is based on the hypothesis that sampling a population where individuals are grouped into well-defined clusters and where there are no individuals outside these clusters using SYS or SBS is equivalent to randomly drawing a sample in a Zero-Inflated Poisson distribution (ZIP). Indeed, the sampling units in the clusters approximately follow a Poisson distribution, and the sampling units outside the clusters constitute an excess of zeros with respect to this Poisson distribution. The computation of our estimator (called V_ZIP) is performed in three steps:  <br>

1. Estimate the two parameters of the ZIP distribution (lambda, the expected mean of the Poisson distribution, and pi, the probability of extra zeros) from the sample by maximum likelihood (Beckett et al., 2014; Jackman et al., 2020).  <br>
2. Compute the population variance estimate using lambda and pi using the following formula : S_hat^2 = lambda * (1 - pi) * (1 + pi * lambda) <br>
3. Compute the sampling variance estimate from the population variance based on the hypothesis that the sample was drawn randomly: v_ZIP = (S_hat^2 / n) * (1 - n/N) <br>


  <br>

**Table S4.1:** Summary of the variance estimators we tested.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# load data
df_estimator_description <- read_csv2(file = "./data/tidy/variance_estimator_table_v3.csv")

# print the table
ft <- flextable(df_estimator_description)
ft <- theme_vanilla(ft)
ft <- align_text_col(ft, align = "left")
ft <- width(ft, width = c(0.9, 0.8, 0.9, 1.1, 2.7))
ft

```

<br>

To evaluate the performance of these estimators, we ran the same simulations as for the main text of the article for both the virtual and natural populations, and for each simulated sampling survey, we computed the variance estimated from the sample with each estimator, and computed the associated 95% confidence interval.  <br>

To save computation time, for the virtual populations we kept only one level of dispersion index out of two, we ran the simulations for 20 populations instead of 60 for each combination of density and aggregation, and realised 600 sampling surveys per population instead of 1,000. For SYS, some of the estimators we selected are not applicable when the units cannot be arranged in a square grid, so we removed the sample sizes of n = 15, 150 and 300.  <br>

For both virtual and natural populations, we present below the following results:  <br>
1. The ratio of the estimated variance (averaged over all the sampling surveys) using each estimator over the true sampling variance to check whether the variance estimates are **biased or not**.  <br>
2. The **coverage ratio** obtained with each estimator, which is the proportion of sampling survey simulations for which the true mean density of individuals was within the 95% confidence interval (CI) of the density of individuals estimated using a given variance estimator.  <br>
3. The ratio of the variance estimated using each variance estimator for SYS and SBS over the variance estimated using the “textbook” estimator for SRS, to show in which situations using SYS or SBS instead of SRS will allow for an **"apparent" gain** in precision.  <br>

<br>

## 1. Virtual populations


```{r, include = FALSE}
# load data
df_estim_result <- read.csv2(file = "./data/tidy/RUN_2022-07-27_variance_estimator_ZIP_results_int1-10-20_nsim600_20_patterns_merged_averaged.csv")

# convert sample_size to factor
df_estim_result$sample_size <- factor(df_estim_result$sample_size, levels = c("9", "25", "49", "100", "196"))

simul_result <- df_estim_result

```


### 1.1 Comparison of estimated variance and true variance

In this section, we compare the mean variance estimates obtained with the variance estimators to the true sampling variances. Only the mean variance estimate is used and there is no measure of estimate precision. Thus, the figures below only allow to assess the average lack of bias of the variance estimators and not their precision. For the assessment of the variance estimate precision, see the next section about the estimator coverage ratio.  <br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

palette <- rev(c('#9e0142', '#f46d43', '#fdae61', '#e6f598', '#66c2a5', '#5e4fa2')) # palette for 6 sample size


### ratio of estimated variance using textbook estimator for SRS, SYS and SBS
figure2_SRS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_random/var_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Random) / True Var(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_syst/var_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Systematic) / True Var(Systematic)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_BAS/var_BAS, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Spatially Balanced) / True Var(Spatially Balanced)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SRS ; figure2_SYS ; figure2_SBS

```

**Figure S4.1:** Ratio of the estimated sampling variance using the "textbook" estimator over the true sampling variance for simple random sampling (SRS), systematic sampling (SYS) and spatially balanced sampling (SBS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). For the populations simulated using the Matern process, density was increased by increasing both kappa and mu (modality 1). Each point of the curves was estimated from 1,000 samples drawn for 20 populations. As expected from sampling theory, using the "textbook" estimator for SYS and SBS leads to a strong overestimation of the sampling variance.  <br>


```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using the 5 estimators for SYS
figure2_SYS_vtextbook <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_syst/var_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(SYS) / True Var(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_v8 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_v8_syst/var_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_8(SYS) / True Var(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vw <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vw_syst/var_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_w(SYS) / True Var(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vstr2 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vstr2_syst/var_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_str2(SYS) / True Var(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vZIP <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vZIP_syst/var_syst, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(SYS) / True Var(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vtextbook ; figure2_SYS_v8 ; figure2_SYS_vw ; figure2_SYS_vstr2 ; figure2_SYS_vZIP

```

**Figure S4.2:** Ratio of the estimated sampling variance using five variance estimators (V_textbook, V_8, V_w, V_str2, V_ZIP) over the true sampling variance for systematic sampling (SYS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). <br>

<br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using 3 estimators for SBS
figure2_SBS_vtextbook <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_BAS/var_BAS, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 2.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(SBS) / True Var(SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vnbh <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vnbh_BAS/var_BAS, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 2.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_nbh(SBS) / True Var(SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vZIP <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vZIP_BAS/var_BAS, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 2.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(SBS) / True Var(SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vtextbook ; figure2_SBS_vnbh ; figure2_SBS_vZIP

```

**Figure S4.3:** Ratio of the estimated sampling variance using three variance estimators (V_textbook, V_nbh and V_ZIP) over the true sampling variance for spatially balanced sampling (SYS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). <br>

<br>

**Interpretation:**  <br>

- As expected from sampling theory, the textbook estimator is unbiased for SRS and tends to overestimate sampling variance for SYS and SBS (Cochran, 1977).  <br>
- For SYS, the three alternative estimators based on correlation of abundance between neighbouring units substantially overestimate the sampling variance at the levels of aggregation where SYS yields the highest increase in precision relative to SRS, i.e. where the distance between sampling units is close to the cluster diameter. Besides these levels of aggregation where all estimators overestimate the variance, V_8 and V_w underestimate the sampling variance by about 10-20%, while V_textbook and V_str2 are unbiased.  <br>
- For SBS, the V_nbh estimator underestimates the sampling variance by about 20% excepted for the higher sample sizes and for the levels of aggregation where SYS yields the highest increase in precision relative to SRS.  <br>
- For SYS, the **V_ZIP estimator is the only one to be nearly unbiased** at the aggregation levels where SYS yields the highest increase in precision relative to SRS. Yet for higher aggregation levels, it underestimates the variance by about 40-50%. For SBS, the V_ZIP estimator is overall more biased than V_nbh.  <br>

<br>


### 1.2 Estimator coverage ratio

In this section, we present the coverage ratio yielded by each variance estimator. The coverage ratio is defined as the proportion of sampling survey simulations for which the true mean density of individuals was within the 95% confidence interval (CI) of the density of individuals estimated using a given variance estimator.  <br>

<br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using textbook estimator for SRS, SYS and SBS
figure2_SRS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SYS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vtextbook_syst, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(Systematic)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SBS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vtextbook_BAS, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(Spatially Balanced)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SRS ; figure2_SYS ; figure2_SBS

```

**Figure S4.4:** Coverage ratio of the "textbook" estimator for simple random sampling (SRS), systematic sampling (SYS) and spatially balanced sampling (SBS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell).  <br>

  <br>


```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using the 5 estimators for SYS
figure2_SYS_vtextbook <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vtextbook_syst, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SYS_v8 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_v8_syst, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_8(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vw <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vw_syst, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_w(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vstr2 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vstr2_syst, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_str2(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vZIP <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vZIP_syst, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_ZIP(SYS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vtextbook ; figure2_SYS_v8 ; figure2_SYS_vw ; figure2_SYS_vstr2 ; figure2_SYS_vZIP

```

**Figure S4.5:** Coverage ratio of five variance estimators (V_textbook, V_8, V_w, V_str2, V_ZIP) for systematic sampling (SYS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). <br>

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using 3 estimators for SBS
figure2_SBS_vtextbook <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vtextbook_BAS, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vnbh <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vnbh_BAS, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_nbh(SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vZIP <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = coverage_vZIP_BAS, color = sample_size)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_ZIP(SBS)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Coverage ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vtextbook ; figure2_SBS_vnbh ; figure2_SBS_vZIP

```

**Figure S4.6:** Coverage ratio of three variance estimators (V_textbook, V_nbh and V_ZIP) for spatially balanced sampling (SYS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell). <br>

**Interpretation:**  <br>

- For the mean density of 1 individual/cell at high aggregation levels, all variance estimators yield low coverage ratio values, and the situation is similar for the three sampling methods, excepted for the largest sample sizes (n = 196 and 400). This is probably due to the high proportion of zeros in the samples for these populations, e.g. for the populations with a mean density of 1 individual/cell and a dispersion index of I = 60, the samples contained on average 97% of zeros, with very little difference between the three sampling methods. For the same level of dispersion index, the proportion of zeros in the samples drops to 76% and 60% for the mean densities of 10 and 20 individuals/cell respectively.  <br> 
- Leaving aside the populations with mean density of 1 individual/cell and the sample size of n = 9, the coverage ratio values are around 0.95 for all the estimators that provided unbiased or overestimated estimates of the sampling variance, and below 0.95 for the estimators that tended to underestimate variance, i.e. V_8, V_w and V_ZIP for SYS, and V_nbh and V_ZIP for SBS.  <br> 


<br>


### 1.3 Comparison of the estimated variance for SYS and SBS to the estimated variance for SRS

In this section, we represent the ratio of the variance estimated using the variance estimators for SYS and SBS over the variance estimated using the “textbook” estimator for SRS. When this ratio is below one, it means that using SYS or SBS with a given estimator yields more precise estimates than using SRS with V_textbook, and when it’s above one, it’s the opposite. The interpretation is difficult here, as several estimators present biased estimates at least for some density and aggregation levels.  <br>

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using textbook estimator for SRS, SYS and SBS
figure2_SYS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_syst/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Systematic) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_BAS/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Spatially Balanced) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS ; figure2_SBS

```

**Figure S4.7:** Ratio of the variance estimated using the "textbook" estimator for systematic sampling (SYS) and spatially balanced sampling (SBS) over the variance estimated for simple random sampling (SRS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell).  <br>

<br>


```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using the 5 estimators for SYS
figure2_SYS_vtextbook <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_syst/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Systematic) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_v8 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_v8_syst/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_8(Systematic) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vw <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vw_syst/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_w(Systematic) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
    labs(color = "Sample size") +   xlab("Dispersion index") +   ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vstr2 <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vstr2_syst/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_str2(Systematic) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vZIP <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vZIP_syst/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(Systematic) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS_vtextbook ; figure2_SYS_v8 ; figure2_SYS_vw ; figure2_SYS_vstr2 ; figure2_SYS_vZIP

```

**Figure S4.8:** Ratio of the variance estimated using five variance estimators (V_textbook, V_8, V_w, V_str2, V_ZIP) for systematic sampling (SYS) over the variance estimated using the "textbook" estimator for simple random sampling (SRS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell).  <br>

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using 3 estimators for SBS
figure2_SBS_vtextbook <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vtextbook_BAS/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Spatially balanced) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vnbh <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vnbh_BAS/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_nbh(Spatially balanced) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vZIP <- ggplot(subset(simul_result, simul_result$theoretical_intensity %in% c(1, 10, 20)),
                      aes(x = expect_disp_ind, y = mean_estim_vZIP_BAS/mean_estim_vtextbook_random, color = sample_size)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.6) + 
  scale_x_continuous(limits = c(-0.1, 76), expand = c(0, 0)) +
  scale_y_continuous(limits = c(0.15, 1.15), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(Spatially balanced) / Var_textbook(Random)") +
  facet_grid(theoretical_intensity ~ .) + 
  theme_light() + 
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  labs(color = "Sample size") +
  xlab("Dispersion index") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS_vtextbook ; figure2_SBS_vnbh ; figure2_SBS_vZIP

```

**Figure S4.9:** Ratio of the variance estimated using three variance estimators (V_textbook, V_nbh and V_ZIP) for spatially balanced sampling (SYS) over the variance estimated using the "textbook" estimator for simple random sampling (SRS), as a function of the dispersion index (I) of the sampled populations. Panels show three different mean densities of individuals (1, 10 and 20 individuals/cell).  <br>

<br>

**Interpretation:**  <br>

- For the aggregation levels where SYS and SBS provide the greatest increase in precision relative to SRS, when using the estimators based on the correlation of abundance among neighbouring units, a gain in precision is on average observed despite the fact that these estimators all tend to overestimate the variance.  <br>
- Under these conditions, the V_ZIP estimator allows for the highest gain in apparent accuracy, for both SYS and SBS.  <br>
- Leaving aside these levels of aggregation, using SYS and the estimators V_8, V_w or V_ZIP, and using SBS and the estimators V_nbh or V_ZIP seem to allow a consistent increase in the observed precision compared to using SRS and the textbook estimator, but this is mostly due to the estimators underestimating the sampling variance, as for these aggregation levels there is almost no difference in true variance between the sampling methods (Fig. 2).  <br>
- The tendency of V_8 and V_w to underestimate sampling variance for SYS was expected given that we simulated aggregated populations using the Matern process. Indeed, for the high levels of aggregation the populations are composed of clusters with a diameter smaller than the distance between the sampling units, and the clusters are randomly located across the study area. Thus the average correlation of abundance among neighbouring units will be around zero, with an equal chance of being positive or negative. But the V_8 and V_w formulas specify that no correction is made to the textbook estimator when the average correlation between neighbouring units is negative, which certainly leads to this tendency to underestimate the sampling variance on average. See McGarvey et al. (2016) pages 245-246 for a more detailed discussion on this topic.  <br>


<br>

## 2. Natural populations

```{r, include = FALSE}
# load data
df_estim_nat_pop <- read.csv2(file = "./data/tidy/RUN_2022-07-26_variance_estimators_natural_populations_with_ZIP_results_merged.csv")

simul_result <- df_estim_nat_pop

```


### 2.1 Comparison of estimated variance and true variance

<br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using textbook estimator for SRS, SYS and SBS
figure2_SRS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = mean_estim_vtextbook_random/var_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#377eb8") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Random) / True Var(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = mean_estim_vtextbook_syst/var_syst)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Systematic) / True Var(Systematic)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = mean_estim_vtextbook_BAS/var_BAS)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Spatially Balanced) / True Var(Spatially Balanced)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SRS ; figure2_SYS ; figure2_SBS

```

**Figure S4.10:** Ratio of the estimated sampling variance using the “textbook” estimator over the true sampling variance for simple random sampling (SRS), systematic sampling (SYS) and spatially balanced sampling (SBS), as a function of sample size for the three natural populations. As expected from sampling theory, using the "textbook" estimator for SYS and SBS leads to a strong overestimation of the sampling variance.  <br>

<br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using the 5 estimators for SYS
figure2_SYS_vtextbook <- ggplot(df_estim_nat_pop,
                                aes(x = sample_size, y = mean_estim_vtextbook_syst/var_syst)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(SYS) / True Var(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_v8 <- ggplot(df_estim_nat_pop,
                         aes(x = sample_size, y = mean_estim_v8_syst/var_syst)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_8(SYS) / True Var(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vw <- ggplot(df_estim_nat_pop,
                         aes(x = sample_size, y = mean_estim_vw_syst/var_syst)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_w(SYS) / True Var(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vstr2 <- ggplot(df_estim_nat_pop,
                            aes(x = sample_size, y = mean_estim_vstr2_syst/var_syst)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_str2(SYS) / True Var(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vZIP <- ggplot(df_estim_nat_pop,
                            aes(x = sample_size, y = mean_estim_vZIP_syst/var_syst)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 4.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(SYS) / True Var(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vtextbook ; figure2_SYS_v8 ; figure2_SYS_vw ; figure2_SYS_vstr2 ; figure2_SYS_vZIP

```

**Figure S4.11:** Ratio of the estimated sampling variance using five variance estimators (V_textbook, V_8, V_w, V_str2, V_ZIP) over the true sampling variance for systematic sampling (SYS), as a function of sample size for the three natural populations.  <br>

<br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using 3 estimators for SBS
figure2_SBS_vtextbook <- ggplot(df_estim_nat_pop,
                                aes(x = sample_size, y = mean_estim_vtextbook_BAS/var_BAS)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.3, 3.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(SBS) / True Var(SBS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS_vnbh <- ggplot(df_estim_nat_pop,
                           aes(x = sample_size, y = mean_estim_vnbh_BAS/var_BAS)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.3, 3.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_nbh(SBS) / True Var(SBS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS_vZIP <- ggplot(df_estim_nat_pop,
                           aes(x = sample_size, y = mean_estim_vZIP_BAS/var_BAS)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.3, 3.5), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(SBS) / True Var(SBS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88"),
        panel.spacing.y = unit(1, "lines")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS_vtextbook ; figure2_SBS_vnbh ; figure2_SBS_vZIP

```

**Figure S4.12:** Ratio of the estimated sampling variance using three variance estimators (V_textbook, V_nbh and V_ZIP) over the true sampling variance for spatially balanced sampling (SYS), as a function of sample size for the three natural populations.  <br>


**Interpretation:**  <br>

- For the population of *Bellis sylvestris* (BELSYL) there is little difference in true sampling variance between the three sampling methods (Fig. 4), and the textbook estimator provides nearly unbiased estimates for SYS and SBS. For the other two populations, V_textbook substantially overestimates the sampling variance (Fig. S4.10).  <br>
- For SYS, V_8 and V_w tend to underestimate the sampling variance as for the virtual populations. The estimates obtained with V_str2 are unbiased or overestimated, but less overestimated than V_textbook. V_ZIP tends to underestimate sampling variance, but less than V_8 and V_w.  <br>
- For SBS, V_nbh provides nearly unbiased estimates despite a tendency to overestimation for larger sample sizes. The V_ZIP estimator also performs fairly well, but less than V_nbh.  <br>

<br>


### 2.2 Estimator coverage ratio

<br>

<br>

```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### textbook estimator for SRS, SYS and SBS
figure2_SRS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = coverage_vtextbook_random)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#377eb8") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SYS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = coverage_vtextbook_syst)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(Systematic)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SBS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = coverage_vtextbook_BAS)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(Spatially Balanced)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SRS ; figure2_SYS ; figure2_SBS

```

**Figure S4.13:** Coverage ratio of the “textbook” estimator for simple random sampling (SRS), systematic sampling (SYS) and spatially balanced sampling (SBS), as a function of sample size for the three natural populations.  <br>

<br>


```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using the 5 estimators for SYS
figure2_SYS_vtextbook <- ggplot(df_estim_nat_pop,
                                aes(x = sample_size, y = coverage_vtextbook_syst)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SYS_v8 <- ggplot(df_estim_nat_pop,
                         aes(x = sample_size, y = coverage_v8_syst)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_8(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SYS_vw <- ggplot(df_estim_nat_pop,
                         aes(x = sample_size, y = coverage_vw_syst)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_w(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SYS_vstr2 <- ggplot(df_estim_nat_pop,
                            aes(x = sample_size, y = coverage_vstr2_syst)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_str2(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SYS_vZIP <- ggplot(df_estim_nat_pop,
                            aes(x = sample_size, y = coverage_vZIP_syst)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_ZIP(SYS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SYS_vtextbook ; figure2_SYS_v8 ; figure2_SYS_vw ; figure2_SYS_vstr2 ; figure2_SYS_vZIP

```

**Figure S4.14:** Coverage ratio of five variance estimators (V_textbook, V_8, V_w, V_str2, V_ZIP) for systematic sampling (SYS), as a function of sample size for the three natural populations.  <br>

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using 3 estimators for SBS
figure2_SBS_vtextbook <- ggplot(df_estim_nat_pop,
                                aes(x = sample_size, y = coverage_vtextbook_BAS)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_textbook(SBS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")
figure2_SBS_vnbh <- ggplot(df_estim_nat_pop,
                           aes(x = sample_size, y = coverage_vnbh_BAS)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_nbh(SBS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SBS_vZIP <- ggplot(df_estim_nat_pop,
                           aes(x = sample_size, y = coverage_vZIP_BAS)) +
  geom_hline(yintercept = 0.95, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0, 1.05), expand = expansion(mult = c(0.05, 0.05))) +
  ggtitle("Coverage Var_ZIP(SBS)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Coverage ratio")

figure2_SBS_vtextbook ; figure2_SBS_vnbh ; figure2_SBS_vZIP

```

**Figure S4.15:** Coverage ratio of three variance estimators (V_textbook, V_nbh and V_ZIP) for spatially balanced sampling (SYS), as a function of sample size for the three natural populations.  <br>

**Interpretation:**  <br>
For small sample sizes (i.e. below n = 75), all estimators have poor coverage for the three sampling methods. For sample sizes above n = 75, all estimators have a coverage ratio around 0.95, except for V_8 and V_w for SYS, which is due to their tendency to underestimation. <br>

<br>


### 2.3 Comparison of the estimated variance for SYS and SBS to the estimated variance for SRS

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### textbook estimator for SRS, SYS and SBS
figure2_SYS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = mean_estim_vtextbook_syst/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0.6, 1.4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Systematic) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SBS <- ggplot(df_estim_nat_pop,
                      aes(x = sample_size, y = mean_estim_vtextbook_BAS/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.6, 1.4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Spatially Balanced) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio") +
  scale_color_manual(values = palette)

figure2_SYS ; figure2_SBS

```

**Figure S4.16:** Ratio of the variance estimated using the “textbook” estimator for systematic sampling (SYS) and spatially balanced sampling (SBS) over the variance estimated for simple random sampling (SRS), as a function of sample size for the three natural populations.  <br>

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using the 5 estimators for SYS
figure2_SYS_vtextbook <- ggplot(df_estim_nat_pop,
                                aes(x = sample_size, y = mean_estim_vtextbook_syst/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0.1, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Systematic) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")
  
figure2_SYS_v8 <- ggplot(df_estim_nat_pop,
                         aes(x = sample_size, y = mean_estim_v8_syst/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0.1, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_8(Systematic) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vw <- ggplot(df_estim_nat_pop,
                         aes(x = sample_size, y = mean_estim_vw_syst/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0.1, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_w(Systematic) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vstr2 <- ggplot(df_estim_nat_pop,
                            aes(x = sample_size, y = mean_estim_vstr2_syst/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0.1, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_str2(Systematic) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vZIP <- ggplot(df_estim_nat_pop,
                            aes(x = sample_size, y = mean_estim_vZIP_syst/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#e41a1c") +
  scale_y_continuous(limits = c(0.1, 1.2), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(Systematic) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SYS_vtextbook ; figure2_SYS_v8 ; figure2_SYS_vw ; figure2_SYS_vstr2 ; figure2_SYS_vZIP

```

**Figure S4.17:** Ratio of the variance estimated using five variance estimators (V_textbook, V_8, V_w, V_str2, V_ZIP) for systematic sampling (SYS) over the variance estimated using the “textbook” estimator for simple random sampling (SRS), as a function of sample size for the three natural populations.  <br>

<br>

```{r , echo = FALSE, message = FALSE, warning = FALSE, fig.height = 4.8, fig.width = 6.4}

### ratio of estimated variance using 3 estimators for SBS
figure2_SBS_vtextbook <- ggplot(df_estim_nat_pop,
                                aes(x = sample_size, y = mean_estim_vtextbook_BAS/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.2, 1.4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_textbook(Spatially balanced) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS_vnbh <- ggplot(df_estim_nat_pop,
                           aes(x = sample_size, y = mean_estim_vnbh_BAS/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.2, 1.4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_nbh(Spatially balanced) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS_vZIP <- ggplot(df_estim_nat_pop,
                           aes(x = sample_size, y = mean_estim_vZIP_BAS/mean_estim_vtextbook_random)) +
  geom_hline(yintercept = 1, linetype = "dashed", size = 0.5) +
  geom_line(size = 0.8, color = "#4daf4a") +
  scale_y_continuous(limits = c(0.2, 1.4), expand = expansion(mult = c(0, 0))) +
  ggtitle("Var_ZIP(Spatially balanced) / Var_textbook(Random)") +
  facet_grid(pattern ~ .) +
  theme_light() +
  theme(legend.position = "bottom", axis.title.x = element_text(size = 11), axis.title.y = element_text(size = 11),
        plot.title = element_text(size = 11), plot.subtitle = element_text(size = 10),
        legend.title = element_text(size = 11),  legend.text = element_text(size = 10),
        axis.text.x = element_text(size = 9), axis.text.y = element_text(size = 9),
        axis.title = element_text(size = 11),
        strip.text.y = element_text(size = 10, colour = "black"),
        strip.background = element_rect(size = 2, colour = "grey88", fill = "grey88")) +
  guides(color = guide_legend(nrow = 1)) +
  xlab("Sample size") +
  ylab("Variance ratio")

figure2_SBS_vtextbook ; figure2_SBS_vnbh ; figure2_SBS_vZIP

```

**Figure S4.18:** Ratio of the variance estimated using three variance estimators (V_textbook, V_nbh and V_ZIP) for spatially balanced sampling (SYS) over the variance estimated using the “textbook” estimator for simple random sampling (SRS), as a function of sample size for the three natural populations.  <br>


**Interpretation:** <br>
We have to exclude sample sizes below n = 75 from the interpretation because all estimators have a low coverage ratio. We also excluded the estimators V_8 and V_w for SYS, as they underestimate variance for all sample sizes and have an overall low coverage ratio. Using SYS with V_str2 or V_ZIP, or SBS with V_nbh or V_ZIP, allows for a substantial gain in apparent precision compared to using SRS with V_textbook. The gain in apparent precision will be close to the gain in true precision, as these estimators are nearly unbiased.  <br>


  <br>
  <br>


## References

- Beckett, S., Jee, J., Ncube, T., Pompilus, S., Washington, Q., Singh, A., & Pal, N. (2014). Zero-inflated Poisson (ZIP) distribution: Parameter estimation and applications to model data from natural calamities. Involve, a Journal of Mathematics, 7(6), 751–767. https://doi.org/10.2140/involve.2014.7.751  \linebreak
- Cochran, W. G. (1977). Sampling Techniques (3rd ed.). John Wiley & Sons.  \linebreak
- D’Orazio, M. (2003). Estimating the variance of the sample mean in two-dimensional systematic sampling. Journal of Agricultural, Biological, and Environmental Statistics, 8(3), 280. https://doi.org/10.1198/1085711032174  \linebreak
- Grafström, A., Lundström, N. L. P., & Schelin, L. (2012). Spatially Balanced Sampling through the Pivotal Method. Biometrics, 68(2), 514–520. https://doi.org/10.1111/j.1541-0420.2011.01699.x  \linebreak
- Jackman, S., Tahk,  with contributions from A., Zeileis, A., Maimone, C., & Meers, J. F. and Z. (2020). pscl: Political Science Computational Laboratory (1.5.5). https://CRAN.R-project.org/package=pscl  \linebreak
- Magnussen, S., & Fehrmann, L. (2019). In search of a variance estimator for systematic sampling. Scandinavian Journal of Forest Research, 34(4), 300–312. https://doi.org/10.1080/02827581.2019.1599063  \linebreak
- Magnussen, S., McRoberts, R. E., Breidenbach, J., Nord-Larsen, T., Ståhl, G., Fehrmann, L., & Schnell, S. (2020). Comparison of estimators of variance for forest inventories with systematic sampling—Results from artificial populations. Forest Ecosystems, 7(1), 17. https://doi.org/10.1186/s40663-020-00223-6  \linebreak
- McGarvey, R., Burch, P., & Matthews, J. M. (2016). Precision of systematic and random sampling in clustered populations: Habitat patches and aggregating organisms. Ecological Applications, 26(1), 233–248. https://doi.org/10.1890/14-1973  \linebreak
- Robertson, B. L., Brown, J. A., McDonald, T., & Jaksons, P. (2013). BAS: Balanced Acceptance Sampling of Natural Resources. Biometrics, 69(3), 776–784. https://doi.org/10.1111/biom.12059  \linebreak
- Stevens, D. L., & Olsen, A. R. (2003). Variance estimation for spatially balanced samples of environmental resources. Environmetrics, 14(6), 593–610. https://doi.org/10.1002/env.606  \linebreak
- Thompson, S. K. (2012). Sampling (3rd ed.). Wiley.  \linebreak
- Wolter, K. M. (2007). Introduction to Variance Estimation (2nd ed.). Springer Science & Business Media.  \linebreak


  <br>
